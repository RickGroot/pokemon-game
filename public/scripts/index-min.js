let pokemonData,score,noWin,socket=io(),socketConnection=io.connect(),room=document.getElementById("room").innerHTML,user=document.getElementById("user").innerHTML,userList=document.getElementById("userList"),message=document.getElementById("message"),form=document.getElementById("form"),button=document.querySelector("input[type=submit]"),output=document.getElementById("output"),pokemonField=document.getElementById("pokemon"),image=document.getElementById("imgP"),winTextTime=3e3,guessTime=3e4;function addWin(){let e=document.querySelector(".thisUser .score span").innerHTML;socket.emit("win",{user:user,room:room,score:e})}function closeRoom(){socket.emit("closeRoom",room)}function updateList(e){userList.innerHTML="",e.forEach(e=>{let o;o=e.userName===user?"thisUser":"user",userList.innerHTML+="<div class="+o+'><p class="username">'+e.userName+'</p><p class="score">Score: <span>'+e.score+"</span></p></div>"})}function disableInput(){message.disabled=!0,button.disabled=!0}function enableInput(){message.disabled=!1,button.disabled=!1}socketConnection.on("connect",()=>{let e={name:user,userId:socket.id,room:room,score:score};socket.emit("join",e)}),form.onsubmit=(e=>(e.preventDefault(),socket.emit("chat",{user:user,room:room,message:message.value}),message.value.toLowerCase()===pokemonData.pokemon.name&&(clearTimeout(noWin),image.classList.remove("animate"),addWin()),form.reset(),!1)),socket.on("userList",e=>updateList(e)),socket.on("chat",e=>{output.innerHTML+="<p><strong>"+e.user+": </strong>"+e.message+"</p>"}),socket.on("win",e=>{disableInput(),output.innerHTML+='<p class="win"><strong>'+e+" has guessed the Pokémon!</strong></p>";let o=document.createElement("h3"),t=document.createTextNode(e+" has guessed correctly!");o.id="winText",o.appendChild(t),pokemonField.appendChild(o),setTimeout(()=>{enableInput(),document.getElementById("winText").remove()},winTextTime)}),socket.on("noWin",()=>{disableInput(),image.classList.remove("animate"),output.innerHTML+='<p class="win"><strong>Nobody guessed correctly</strong></p>';let e=document.createElement("h3"),o=document.createTextNode("The Pokémon was "+pokemonData.pokemon.name);e.id="winText",e.appendChild(o),pokemonField.appendChild(e),setTimeout(()=>{enableInput(),document.getElementById("winText").remove()},winTextTime)}),socket.on("gameWin",e=>{disableInput();let o=document.createElement("h3"),t=document.createTextNode(e+" has won the game!");o.id="winText",o.appendChild(t),pokemonField.appendChild(o),image.src="",output.innerHTML+='<p class="win"><strong>'+e+" has won!</strong></p>",setTimeout(()=>{closeRoom()},5e3)}),socket.on("closeRoom",()=>{window.location.href="/"}),socket.on("pokemon",e=>{e?setTimeout(()=>{pokemonData=e,image.src=e.pokemon.img,image.classList.add("animate")},winTextTime):socket.emit("request",room)});